@startuml CTU Analysis Verbs - New Verb Workflow Sequence

!theme aws-orange
skinparam backgroundColor #FAFAFA
skinparam sequenceArrowThickness 2
skinparam roundcorner 20
skinparam maxmessagesize 80
skinparam noteBackgroundColor #FFF3E0
skinparam noteBorderColor #FF9800

title CTU Analysis Verbs - New Verb Workflow Sequence\nðŸš€ Innovative AST-Based Analysis Pipeline

actor "ðŸ‘¤ Developer" as Dev
participant "ðŸ“± CLI Interface" as CLI
participant "ðŸŽ¯ Command Router" as Router
participant "ðŸ” Discover Verb" as Discover
participant "ðŸ“Š Coverage Verb" as Coverage
participant "ðŸ’¡ Recommend Verb" as Recommend
participant "âš¡ Profile Verb" as Profile
participant "âœ… Validate Verb" as Validate
participant "ðŸ“¤ Export Verb" as Export
participant "ðŸ§  AST Engine" as ASTEngine

== ðŸš€ Primary Analysis Workflow ==

Dev -> CLI: ctu analysis discover --cli-path src/cli.mjs
CLI -> Router: route discover command
Router -> Discover: execute discovery
activate Discover

Discover -> ASTEngine: discoverCLIStructureEnhanced()
activate ASTEngine
ASTEngine -> ASTEngine: parse CLI definition AST
ASTEngine -> ASTEngine: extract imported commands
ASTEngine -> ASTEngine: build command hierarchy
ASTEngine -> ASTEngine: validate structure integrity
ASTEngine --> Discover: CLI structure
deactivate ASTEngine

Discover --> CLI: CLI structure report
deactivate Discover
CLI --> Dev: âœ… CLI structure discovered

note right of Discover
  **ðŸ” Discovery Results:**
  - Commands: 5 discovered
  - Subcommands: 15 discovered
  - Flags: 8 discovered
  - Options: 3 discovered
  - Imports: 5 resolved
end note

Dev -> CLI: ctu analysis coverage --test-dir test
CLI -> Router: route coverage command
Router -> Coverage: execute coverage analysis
activate Coverage

Coverage -> ASTEngine: discoverTestPatternsAST()
activate ASTEngine
ASTEngine -> ASTEngine: scan test directory
ASTEngine -> ASTEngine: parse test file ASTs
ASTEngine -> ASTEngine: extract test patterns
ASTEngine -> ASTEngine: calculate coverage
ASTEngine --> Coverage: coverage statistics
deactivate ASTEngine

Coverage --> CLI: coverage analysis report
deactivate Coverage
CLI --> Dev: ðŸ“Š Coverage: 75% overall

note right of Coverage
  **ðŸ“Š Coverage Results:**
  - Commands: 4/5 (80%)
  - Subcommands: 12/15 (80%)
  - Flags: 6/8 (75%)
  - Options: 2/3 (67%)
  - Overall: 24/31 (77%)
end note

Dev -> CLI: ctu analysis recommend --priority high
CLI -> Router: route recommend command
Router -> Recommend: execute recommendations
activate Recommend

Recommend -> ASTEngine: generateRecommendations()
activate ASTEngine
ASTEngine -> ASTEngine: analyze coverage gaps
ASTEngine -> ASTEngine: prioritize untested items
ASTEngine -> ASTEngine: generate actionable suggestions
ASTEngine -> ASTEngine: create improvement plans
ASTEngine --> Recommend: smart recommendations
deactivate ASTEngine

Recommend --> CLI: recommendation report
deactivate Recommend
CLI --> Dev: ðŸ’¡ 5 high-priority recommendations

note right of Recommend
  **ðŸ’¡ Smart Recommendations:**
  1. [HIGH] Add tests for 'export' command
  2. [HIGH] Add tests for '--verbose' flag
  3. [MEDIUM] Add tests for 'compare' subcommand
  4. [MEDIUM] Add tests for '--format' option
  5. [LOW] Add tests for '--output' option
end note

== âš¡ Performance & Validation Workflow ==

Dev -> CLI: ctu analysis profile --benchmark
CLI -> Router: route profile command
Router -> Profile: execute profiling
activate Profile

Profile -> ASTEngine: profileAnalysis()
activate ASTEngine
ASTEngine -> ASTEngine: monitor execution performance
ASTEngine -> ASTEngine: detect bottlenecks
ASTEngine -> ASTEngine: analyze resource usage
ASTEngine -> ASTEngine: generate optimization suggestions
ASTEngine --> Profile: performance report
deactivate ASTEngine

Profile --> CLI: performance profile
deactivate Profile
CLI --> Dev: âš¡ Performance: 2.3s analysis time

note right of Profile
  **âš¡ Performance Results:**
  - Analysis Time: 2.3s
  - Memory Usage: 45MB
  - Cache Hit Rate: 95%
  - Bottlenecks: None detected
  - Optimization: Already optimized
end note

Dev -> CLI: ctu analysis validate --strict
CLI -> Router: route validate command
Router -> Validate: execute validation
activate Validate

Validate -> ASTEngine: validateCLIStructure()
activate ASTEngine
ASTEngine -> ASTEngine: validate structure integrity
ASTEngine -> ASTEngine: check import resolution
ASTEngine -> ASTEngine: verify test consistency
ASTEngine -> ASTEngine: detect issues
ASTEngine --> Validate: validation report
deactivate ASTEngine

Validate --> CLI: validation report
deactivate Validate
CLI --> Dev: âœ… Validation: All checks passed

note right of Validate
  **âœ… Validation Results:**
  - Structure Integrity: âœ… Passed
  - Import Resolution: âœ… Passed
  - Test Consistency: âœ… Passed
  - Issue Detection: âœ… No issues found
  - Quality Score: 95/100
end note

== ðŸ“¤ Export & Integration Workflow ==

Dev -> CLI: ctu analysis export --format json --output coverage.json
CLI -> Router: route export command
Router -> Export: execute export
activate Export

Export -> ASTEngine: exportAnalysisData()
activate ASTEngine
ASTEngine -> ASTEngine: gather all analysis data
ASTEngine -> ASTEngine: format for export
ASTEngine -> ASTEngine: serialize data
ASTEngine --> Export: formatted data
deactivate ASTEngine

Export -> Export: writeToFile(coverage.json)
Export --> CLI: export confirmation
deactivate Export
CLI --> Dev: ðŸ“¤ Exported to coverage.json

note right of Export
  **ðŸ“¤ Export Results:**
  - Format: JSON
  - File: coverage.json
  - Size: 15KB
  - Records: 31 coverage items
  - Metadata: Complete
end note

== ðŸ”„ Advanced Workflow Examples ==

note over Dev, ASTEngine
  **ðŸ”„ Advanced Workflows:**
  
  **Continuous Monitoring:**
  ctu analysis monitor --watch --interval 30
  
  **Comparison Analysis:**
  ctu analysis compare --baseline old.json --current new.json
  
  **Batch Processing:**
  ctu analysis discover && ctu analysis coverage && ctu analysis recommend
  
  **CI/CD Integration:**
  ctu analysis coverage --threshold 80 --format json | jq '.coverage.overall.percentage'
end note

== ðŸš€ Innovation Highlights ==

note over Discover, Recommend
  **ðŸš€ Innovation Benefits:**
  
  **AST-First Design**
  - 100% accurate CLI structure discovery
  - Precise test pattern matching
  - Dynamic import resolution
  
  **Smart Recommendations**
  - AI-powered improvement suggestions
  - Priority-based ranking
  - Actionable guidance
  
  **Performance Optimization**
  - Real-time performance monitoring
  - Bottleneck detection
  - Optimization suggestions
  
  **Quality Assurance**
  - Structure validation
  - Integrity checking
  - Consistency verification
end note

== ðŸ“Š Workflow Benefits ==

note bottom
  **ðŸ“Š Workflow Benefits:**
  
  **Clear Progression**
  - discover â†’ coverage â†’ recommend
  - Logical command sequence
  - Progressive analysis depth
  
  **Comprehensive Analysis**
  - Structure discovery
  - Coverage analysis
  - Smart recommendations
  - Performance profiling
  - Quality validation
  
  **Flexible Integration**
  - Individual command execution
  - Batch processing support
  - CI/CD pipeline integration
  - Continuous monitoring
  
  **Enhanced Developer Experience**
  - Intuitive command names
  - Clear output formatting
  - Actionable recommendations
  - Performance insights
end note

@enduml
